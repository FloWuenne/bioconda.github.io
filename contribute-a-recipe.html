
<!DOCTYPE html>

<html xmlns="http://www.w3.org/1999/xhtml">
  <head>
    <meta charset="utf-8" />
    <title>Contributing a recipe &#8212; Bioconda  documentation</title>
    <link rel="stylesheet" href="_static/alabaster.css" type="text/css" />
    <link rel="stylesheet" href="_static/pygments.css" type="text/css" />
    <link rel="stylesheet" type="text/css" href="_static/style.css" />
    <link rel="stylesheet" type="text/css" href="_static/font-awesome-4.7.0/css/font-awesome.min.css" />
    <script type="text/javascript" id="documentation_options" data-url_root="./" src="_static/documentation_options.js"></script>
    <script type="text/javascript" src="_static/jquery.js"></script>
    <script type="text/javascript" src="_static/underscore.js"></script>
    <script type="text/javascript" src="_static/doctools.js"></script>
    <script type="text/javascript" src="_static/language_data.js"></script>
    <link rel="index" title="Index" href="genindex.html" />
    <link rel="search" title="Search" href="search.html" />
    <link rel="next" title="Troubleshooting failed recipes" href="troubleshooting.html" />
    <link rel="prev" title="One-time setup" href="contrib-setup.html" />
    <link href="https://fonts.googleapis.com/css?family=Lato|Raleway" rel="stylesheet">
    <link href="https://fonts.googleapis.com/css?family=Inconsolata" rel="stylesheet">

    <link rel="apple-touch-icon" sizes="57x57" href="_static/apple-icon-57x57.png">
    <link rel="apple-touch-icon" sizes="60x60" href="_static/apple-icon-60x60.png">
    <link rel="apple-touch-icon" sizes="72x72" href="_static/apple-icon-72x72.png">
    <link rel="apple-touch-icon" sizes="76x76" href="_static/apple-icon-76x76.png">
    <link rel="apple-touch-icon" sizes="114x114" href="_static/apple-icon-114x114.png">
    <link rel="apple-touch-icon" sizes="120x120" href="_static/apple-icon-120x120.png">
    <link rel="apple-touch-icon" sizes="144x144" href="_static/apple-icon-144x144.png">
    <link rel="apple-touch-icon" sizes="152x152" href="_static/apple-icon-152x152.png">
    <link rel="apple-touch-icon" sizes="180x180" href="_static/apple-icon-180x180.png">
    <link rel="icon" type="image/png" sizes="192x192"  href="_static/android-icon-192x192.png">
    <link rel="icon" type="image/png" sizes="32x32" href="_static/favicon-32x32.png">
    <link rel="icon" type="image/png" sizes="96x96" href="_static/favicon-96x96.png">
    <link rel="icon" type="image/png" sizes="16x16" href="_static/favicon-16x16.png">
    <meta name="msapplication-TileColor" content="#ffffff">
    <meta name="msapplication-TileImage" content="_static/ms-icon-144x144.png">

    <link rel="manifest" href="/manifest.json">
    <meta name="theme-color" content="#ffffff">

   
  <link rel="stylesheet" href="_static/custom.css" type="text/css" />
  
  
  <meta name="viewport" content="width=device-width, initial-scale=0.9, maximum-scale=0.9" />


  </head><body>
  <div class="document">
    
      <div class="sphinxsidebar" role="navigation" aria-label="main navigation">
        <div class="sphinxsidebarwrapper">
<p class="logo">
  <a href="index.html">
    <img class="logo" src="_static/logo/bioconda_monochrome_small.png" alt="Logo"/>
    
  </a>
</p>








<h3>Navigation</h3>
<ul class="current">
<li class="toctree-l1 current"><a class="reference internal" href="contributing.html">Contributing</a><ul class="current">
<li class="toctree-l2"><a class="reference internal" href="contrib-setup.html">One-time setup</a></li>
<li class="toctree-l2 current"><a class="current reference internal" href="#">Contributing a recipe</a><ul>
<li class="toctree-l3"><a class="reference internal" href="#update-repo">1. Update repo</a></li>
<li class="toctree-l3"><a class="reference internal" href="#write-a-recipe">2. Write a recipe</a></li>
<li class="toctree-l3"><a class="reference internal" href="#test-locally-optional">3. Test locally (optional)</a></li>
<li class="toctree-l3"><a class="reference internal" href="#push-changes-wait-for-tests-to-pass-submit-pull-request">4. Push changes, wait for tests to pass, submit pull request</a></li>
<li class="toctree-l3"><a class="reference internal" href="#use-your-new-recipe">6. Use your new recipe</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="troubleshooting.html">Troubleshooting failed recipes</a></li>
<li class="toctree-l2"><a class="reference internal" href="build-system.html">Build system</a></li>
<li class="toctree-l2"><a class="reference internal" href="guidelines.html">Guidelines for <code class="docutils literal notranslate"><span class="pre">bioconda</span></code> recipes</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="updating.html">Updating recipes</a></li>
<li class="toctree-l1"><a class="reference internal" href="updating.html#updating-recipes-for-a-pinning-change">Updating recipes for a pinning change</a></li>
<li class="toctree-l1"><a class="reference internal" href="linting.html">Linting</a></li>
<li class="toctree-l1"><a class="reference internal" href="faqs.html">FAQs</a></li>
<li class="toctree-l1"><a class="reference internal" href="build-system.html">Build system</a></li>
<li class="toctree-l1"><a class="reference internal" href="cb3.html">Conda build v3</a></li>
<li class="toctree-l1"><a class="reference internal" href="developer.html">Developer Docs</a></li>
</ul>

<ul>
  
  <li class="toctree-l1"><a href="https://github.com/bioconda/bioconda-recipes">Bioconda @ Github</a></li>
  
  <li class="toctree-l1"><a href="conda-recipe_index.html">Recipe Index</a></li>
  
  <li class="toctree-l1"><a href="https://gitter.im/bioconda/Lobby"><img alt="Gitter" src="https://img.shields.io/gitter/room/bioconda/Lobby.svg"></a></li>
  
</ul>
<div id="searchbox" style="display: none" role="search">
  <h3 id="searchlabel">Quick search</h3>
    <div class="searchformwrapper">
    <form class="search" action="search.html" method="get">
      <input type="text" name="q" aria-labelledby="searchlabel" />
      <input type="submit" value="Go" />
    </form>
    </div>
</div>
<script type="text/javascript">$('#searchbox').show(0);</script>
        </div>
      </div>
      <div class="documentwrapper">
        <div class="bodywrapper">
          

          <div class="body" role="main">
            
  <div class="section" id="contributing-a-recipe">
<h1>Contributing a recipe<a class="headerlink" href="#contributing-a-recipe" title="Permalink to this headline">¶</a></h1>
<p>The following steps are done for each recipe or batch of recipes you’d like to
contribute.</p>
<div class="section" id="update-repo">
<h2>1. Update repo<a class="headerlink" href="#update-repo" title="Permalink to this headline">¶</a></h2>
<p>If you’re using a fork (set up as <a class="reference internal" href="contrib-setup.html#github-setup"><span class="std std-ref">above</span></a>):</p>
<div class="highlight-bash notranslate"><div class="highlight"><pre><span></span>git checkout master
git pull upstream master
git push origin master
</pre></div>
</div>
<p>If you’re using a clone:</p>
<div class="highlight-bash notranslate"><div class="highlight"><pre><span></span>git checkout master
git pull origin master
</pre></div>
</div>
</div>
<div class="section" id="write-a-recipe">
<h2>2. Write a recipe<a class="headerlink" href="#write-a-recipe" title="Permalink to this headline">¶</a></h2>
<p>Check out a new branch (here the branch is arbitrarily named “my-recipe”):</p>
<div class="highlight-bash notranslate"><div class="highlight"><pre><span></span>git checkout -b my-recipe
</pre></div>
</div>
<p>and write one or more recipes. The <a class="reference external" href="https://conda.io/projects/conda-build/en/latest/index.html#index" title="(in conda build v3.18.2+23.g57154a6e.dirty)"><code class="xref any docutils literal notranslate"><span class="pre">conda-build</span> <span class="pre">docs</span></code></a> are the authoritative source for information on
building a recipe.</p>
<p>Please familiarize yourself with the <a class="reference internal" href="guidelines.html#guidelines"><span class="std std-ref">Guidelines for bioconda recipes</span></a> for details on
bioconda-specific policies.</p>
</div>
<div class="section" id="test-locally-optional">
<span id="test-locally"></span><h2>3. Test locally (optional)<a class="headerlink" href="#test-locally-optional" title="Permalink to this headline">¶</a></h2>
<p>There are currently two options for local testing: 1) using the Circle CI
client and 2) setting up a separate Miniconda installation and running
bioconda-utils. The first is potentially simpler to set up but less flexible.</p>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>If you use the Circle CI client method and receive errors then please try <code class="docutils literal notranslate"><span class="pre">bioconda-utils</span> <span class="pre">build</span></code> instead.</p>
</div>
<div class="section" id="circle-ci-client-method">
<span id="cci-clent"></span><h3>Circle CI client method<a class="headerlink" href="#circle-ci-client-method" title="Permalink to this headline">¶</a></h3>
<p>The simplest way to conduct local tests is to <a class="reference internal" href="contrib-setup.html#circleci-client"><span class="std std-ref">setup the Circle CI client</span></a>. Then run the following commands:</p>
<div class="highlight-bash notranslate"><div class="highlight"><pre><span></span><span class="c1"># Ensure the build container is up-to-date</span>
docker pull bioconda/bioconda-utils-build-env

<span class="c1"># Run the build locally</span>
circleci build
</pre></div>
</div>
<p>in the root of your repository clone. This command effectively runs the recipe
linting and then  <code class="docutils literal notranslate"><span class="pre">conda</span> <span class="pre">build</span></code> on all recipes recently changed. It does so
in an environment with properly configured channels.</p>
</div>
<div class="section" id="bootstrap-method">
<span id="bootstrap"></span><h3>“Bootstrap” method<a class="headerlink" href="#bootstrap-method" title="Permalink to this headline">¶</a></h3>
<p>Due to technical limitations of the Circle CI client, the above test does
<strong>not</strong> run the more stringent <code class="docutils literal notranslate"><span class="pre">mulled-build</span></code> tests. To do so, use the
following commands:</p>
<div class="highlight-bash notranslate"><div class="highlight"><pre><span></span>./bootstrap.py /tmp/miniconda
<span class="nb">source</span> ~/.config/bioconda/activate

<span class="c1"># optional linting</span>
bioconda-utils lint recipes config.yml --git-range master

<span class="c1"># build and test</span>
bioconda-utils build recipes config.yml --docker --mulled-test --git-range master
</pre></div>
</div>
<p>The above commands do the following:</p>
<ul class="simple">
<li><p>install a separate miniconda installation in a temporary directory, set up
bioconda channels, install bioconda-utils dependencies into the root
environment of that installation, and write the file
<code class="docutils literal notranslate"><span class="pre">~/.config/bioconda/activate</span></code></p></li>
<li><p>source that new file to specifically activate the root environment of that
new installation</p></li>
<li><p>run bioconda-utils in that new installation</p></li>
</ul>
<p>If you do not have access to Docker, you can still run the basic test by
telling the bootstrap setup to not use docker, and by excluding the
<code class="docutils literal notranslate"><span class="pre">--docker</span></code> and <code class="docutils literal notranslate"><span class="pre">--mulled-test</span></code> arguments in the last command:</p>
<div class="highlight-bash notranslate"><div class="highlight"><pre><span></span>./bootstrap.py --no-docker /tmp/miniconda
<span class="nb">source</span> ~/.config/bioconda/activate
bioconda-utils build recipes config.yml --git-range master
</pre></div>
</div>
</div>
<div class="section" id="updating-recipes">
<h3>Updating recipes<a class="headerlink" href="#updating-recipes" title="Permalink to this headline">¶</a></h3>
<p><a class="reference internal" href="bioconda-utils.html"><span class="doc">bioconda-utils</span></a> now has the ability to automatically update packages and
submit a PR on your behalf. Note that the auto-updater does not yet know how to
monitor changed dependencies, so it is important to verify that the updated
recipe reflects all the changes. This tool is most useful when scanning
packages to know when something has been updated.</p>
<div class="highlight-bash notranslate"><div class="highlight"><pre><span></span>bioconda-utils update recipes/ config.yml --packages &lt;my-package-name&gt;
</pre></div>
</div>
<p>will update the package’s recipe which you can then inspect. If you have
a <a class="reference external" href="https://help.github.com/articles/creating-a-personal-access-token-for-the-command-line/">GitHub personal access token</a>
set as the environment variable <code class="docutils literal notranslate"><span class="pre">GITHUB_TOKEN</span></code>, the following command will
additionally submit a pull request on your behalf:</p>
<div class="highlight-bash notranslate"><div class="highlight"><pre><span></span>bioconda-utils update recipes/ config.yml <span class="se">\</span>
  --packages &lt;my-package-name&gt; <span class="se">\</span>
  --create-pr
</pre></div>
</div>
<p>For more details, see the <a class="reference internal" href="updating.html#updating"><span class="std std-ref">Updating recipes</span></a> section.</p>
</div>
</div>
<div class="section" id="push-changes-wait-for-tests-to-pass-submit-pull-request">
<h2>4. Push changes, wait for tests to pass, submit pull request<a class="headerlink" href="#push-changes-wait-for-tests-to-pass-submit-pull-request" title="Permalink to this headline">¶</a></h2>
<p>Push your changes to your fork or to the main repo (if using a clone) to GitHub:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">git</span> <span class="n">push</span> <span class="o">-</span><span class="n">u</span> <span class="n">origin</span> <span class="n">my</span><span class="o">-</span><span class="n">recipe</span>
</pre></div>
</div>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p><strong>Update March 2018:</strong> If using a fork, please do not enable Circle CI for it.
If you have enabled CircleCI to build your fork in the past, please disable it
under <a class="reference external" href="https://circleci.com/dashboard">https://circleci.com/dashboard</a> (look for the big red “Stop Building”
button). See <a class="reference internal" href="faqs.html#circlecimacos"><span class="std std-ref">CircleCI macOS plans</span></a> for more details.</p>
</div>
<p>You can view the test status next to your commits in Github.
Make and push changes as needed to get the tests to pass.
Once they pass, create a <a class="reference external" href="https://help.github.com/articles/about-pull-requests/">pull request</a> on the main bioconda
repo for your changes.
If</p>
<ul class="simple">
<li><p>it’s your first recipe,</p></li>
<li><p>the recipe is doing something non-standard or</p></li>
<li><p>it adds a new package</p></li>
</ul>
<p>please ask <code class="docutils literal notranslate"><span class="pre">&#64;bioconda/core</span></code> for a review. If you are a member
of the bioconda team and none of above criteria apply, feel free to merge your
recipe once the tests pass.</p>
</div>
<div class="section" id="use-your-new-recipe">
<h2>6. Use your new recipe<a class="headerlink" href="#use-your-new-recipe" title="Permalink to this headline">¶</a></h2>
<p>When the PR is merged with the master branch, Circle CI will again do the
builds but at the end will upload the packages to anaconda.org. Once this
completes, and as long as the channels are set up as described in
<a class="reference internal" href="index.html#set-up-channels"><span class="std std-ref">2. Set up channels</span></a>, your new package is installable by anyone using:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">conda</span> <span class="n">install</span> <span class="n">my</span><span class="o">-</span><span class="n">package</span><span class="o">-</span><span class="n">name</span>
</pre></div>
</div>
<p>It is recommended that users set up channels as described in
<a class="reference internal" href="index.html#set-up-channels"><span class="std std-ref">2. Set up channels</span></a> to ensure that packages and dependencies are handled
correctly, and that they create an isolated environment when installing using
<code class="docutils literal notranslate"><span class="pre">conda</span> <span class="pre">create</span> <span class="pre">-n</span> <span class="pre">env-name-here</span></code>.</p>
</div>
</div>


          </div>
          
        </div>
      </div>
    <div class="clearer"></div>
  </div>
    <div class="footer">
      &copy;2016-2019, The Bioconda Team.
      
      |
      Powered by <a href="http://sphinx-doc.org/">Sphinx 2.1.0</a>
      &amp; <a href="https://github.com/bitprophet/alabaster">Alabaster 0.7.12</a>
      
      |
      <a href="_sources/contribute-a-recipe.rst.txt"
          rel="nofollow">Page source</a>
    </div>

    

    <div class="git-ribbon">
      <a href="https://github.com/bioconda/bioconda-utils/edit/master/docs/source/contribute-a-recipe.rst" rel="me">Edit me on GitHub</a>
    </div>
  </body>
</html>